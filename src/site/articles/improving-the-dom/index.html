---
layout: default
title: "Improving the DOM"
---

<h1>Improving the Dom</h1>
<em>Written by Bob Nystrom<br />
October 2011</em>

<p>One of the great opportunities a new language gives you is a chance to also re-invent a cleaner set of APIs for users to work with. When it comes to coding in a browser, that API is the DOM. The DOM API that JavaScripters suffer is creaking under the weight of history and technological ballast like XML.</p>

<p>We have the chance to blow away a lot of that history and were lucky enough to get Alex Russell and Erik Arvidsson to help us lay out what the DOM could have looked like if they knew then what we knew now. What we have still needs a lot of work and feedback from people like you, but it's already promising. Here's a glimpse.</p>

<h2>Simpler Names</h2>

<p>The simplest changes were just cleaning up some painful names. <code>HTMLElement</code> is just <code>Element</code> and we've dropped <code>HTML</code> from most of the type names. Instead of <code>childNodes</code> and <code>children</code> we've got <code>nodes</code> and <code>elements</code>. <code>ownerDocument</code> is just <code>document</code>. We've tried to optimize names so that the things you use the most are the most terse.</p>

<h2>Use Real Collections</h2>

<p>In JavaScript, the DOM collection types are different from the built-in Array type, which trips users up when methods they use on one aren't available on the other. For Dart, we've cleaned that up. The object returned by <code>elements</code> implements Dart's the core library's <code>List&ltElement&gt;</code> interface and works exactly like a built-in collection.</p>

<p>Building on top of Dart's collection types lets us get rid of a bunch of special-case methods too. Instead of a bunch of methods on <code>Element</code> for working with attributes, we just made <code>attributes</code> a map:</p>

<table width="100%">
<tr>
<td width="50%">
<pre>
// Old:
elem.hasAttribute('name');
elem.getAttribute('name')
elem.setAttribute('name', 'value');
elem.removeAttribute('name');
</pre>
</td>
<td width="50%">
<pre>
// New:
elem.attributes.contains('name');
elem.attributes['name'];
elem.attributes['name'] = 'value';
elem.attributes.remove('name');
</pre>
</td>
</tr>
</table>

<p>Likewise, by making <code>nodes</code> and <code>elements</code> full-featured collections, we can get rid of a bunch of methods on <code>Element</code> and <code>Node</code>:</p>

<table width="100%">
<tr>
<td width="50%">
<pre>
// Old:
elem.hasChildNodes();
elem.firstChild();
elem.appendChild(child);
</pre>
</td>
<td width="50%">
<pre>
// New:
!elem.nodes.isEmpty;
elem.nodes.first;
elem.nodes.add(child);
</pre>
</td>
</tr>
</table>

<h2>Use Constructors</h2>

<p>In order to create new instance of DOM types, you're forced to go through factory methods on the document. We like constructors:</p>

<table width="100%">
<tr>
<td width="50%">
<pre>
// Old:
document.createElement('div');
</pre>
</td>
<td width="50%">
<pre>
// New:
new Element.tag('div');
</pre>
</td>
</tr>
</table>

Or you can even do:

<pre>
TableElement table = new Element.html('<table><tr><td>Hello</table>');
</pre>

<h2>Events</h2>


